USE [db_library_mgmt_zach_murray]

CREATE TABLE LIBRARY_BRANCH (
	BranchID INT PRIMARY KEY NOT NULL IDENTITY (2001,1),
	BranchName VARCHAR(50) NOT NULL,
	Address VARCHAR(100) NOT NULL
	);

CREATE TABLE PUBLISHER (
	PublisherName VARCHAR(100) PRIMARY KEY NOT NULL,
	Address VARCHAR(100) NOT NULL,
	Phone VARCHAR(20)
	);

CREATE TABLE BOOKS (
	BookID INT PRIMARY KEY NOT NULL IDENTITY (3001,1),
	Title VARCHAR(100) NOT NULL,
	PublisherName VARCHAR(100) FOREIGN KEY REFERENCES PUBLISHER(PublisherName)
	);

CREATE TABLE BORROWER (
	CardNo INT PRIMARY KEY NOT NULL IDENTITY (4001,1),
	Name VARCHAR(100) NOT NULL,
	Address VARCHAR(100) NOT NULL,
	Phone VARCHAR(20)
	);

CREATE TABLE BOOK_AUTHORS (
	BookID INT FOREIGN KEY REFERENCES BOOKS(BookID),
	AuthorName VARCHAR(100) NOT NULL
	);

	

CREATE TABLE BOOK_COPIES (
	BookID INT FOREIGN KEY REFERENCES BOOKS(BookID),
	BranchID INT FOREIGN KEY REFERENCES LIBRARY_BRANCH(BranchID),
	Number_Of_Copies INT NOT NULL
	);


CREATE TABLE BOOK_LOANS (
	BookID INT FOREIGN KEY REFERENCES BOOKS(BookID),
	BranchID INT FOREIGN KEY REFERENCES LIBRARY_BRANCH(BranchID),
	CardNo INT FOREIGN KEY REFERENCES BORROWER(CardNo),
	DateOut DATE NOT NULL,
	DateDue DATE NOT NULL,
	);

INSERT INTO LIBRARY_BRANCH
	(BranchName, Address)
	VALUES
	('Central', '123 Central Street'),
	('Sharpstown', '6200 Hermann Park Dr.'),
	('New York', '2300 Southern Blvd, Bronx, NY'),
	('Chicago', '2001 N Clark St, Chicago, IL '),
	('Las Vegas', '3600 S Las Vegas Blvd, Las Vegas, NV'),
	('Los Angelas', '1000 Vin Scully Ave, Los Angeles, CA')
	;

INSERT INTO PUBLISHER
	(PublisherName, Address, Phone)
	VALUES
	('Pan Macmillan Grp','175 5th Ave, New York, NY 10010','1 800-221-7945'),
	('Transworld Grp','20 Vauxhall Bridge Road London, SW1V 2SA','+44 (0)20 7840 8400'),
	('Bloomsbury Grp','50 Bedford Square, London, WC1B 3DP','+44 (0)20 7631 5600'),
	('Little, Brown Book Grp','50 Victoria Embankment, London, EC4Y 0DZ','+44 (0)20 3122 7000'),
	('Random House Grp','1745 Broadway, New York, NY 10010','1-800-733-3000.'),
	('Quercus Grp','50 Victoria Embankment, London, EC4Y 0DZ','+44 (0) 20 3122 6000'),
	('Penguin Grp','27 Wrights Lane, London W8 5TZ','1-800-733-3000.'),
	('Orion Grp','50 Victoria Embankment, London, EC4Y 0DZ','020 3122 6444'),
	('HarperCollins Grp','195 Broadway, New York, NY 10007','1-800-242-7737'),
	('Headline Grp','50 Victoria Embankment, London, EC4Y 0DZ','+44 20 3122 7222'),
	('Picador US','3 Holford Yard, Bevin Way, London WC1X 9HD','+44 (0)20 7841 6300'),
	('Simon & Schuster','1230 Avenue of the Americas, New York, NY 10020','212-698-7000')
	;

INSERT INTO BOOKS
	(Title, PublisherName)
	VALUES
	('The Lost Tribe', 'Picador US'),
	('Da Vinci Code,The', 'Transworld Grp'),
	('Harry Potter and the Philosophers Stone', 'Bloomsbury Grp'),
	('Twilight', 'Little, Brown Book Grp'),
	('Lovely Bones,The', 'Pan Macmillan Grp'),
	('Curious Incident of the Dog in the Night-time,The#', 'Random House Grp'),
	('Girl with the Dragon Tattoo,The:Millennium Trilogy#', 'Quercus Grp'),
	('Kite Runner,The', 'Bloomsbury Grp'),
	('Time Travelers Wife,The', 'Random House Grp'),
	('World According to Clarkson,The', 'Penguin Grp'),
	('Atonement', 'Random House Grp'),
	('Short History of Nearly Everything,A', 'Transworld Grp'),
	('Child Called It,A', 'Orion Grp'),
	('No.1 Ladies Detective Agency,The', 'Little, Brown Book Grp'),
	('You are What You Eat', 'Penguin Grp'),
	('Man and Boy', 'HarperCollins Grp'),
	('Birdsong', 'Random House Grp'),
	('Labyrinth', 'Orion Grp'),
	('Island,The', 'Headline Grp'),
	('The Shining', 'Simon & Schuster'),
	('IT', 'Simon & Schuster')
	;

INSERT INTO BORROWER
	(Name, Address, Phone)
	VALUES
	('Keeley Iles','2226 Layman Court','(203) 687-3536'),
	('Nell Finney','4232 Renwick Drive','(775) 363-3092'),
	('Jarrod Carter','2243 West Street','(652) 544-9750'),
	('Sonya Rojas','3483 Elliott Street','(358) 934-0763'),
	('Rueben Goff','1269 Timber Ridge Road','(698) 951-0890'),
	('Sania Mcmanus','2296 Franklin Street','(867) 487-9728'),
	('Zakariyah Baldwin','239 Hart Street','(685) 246-3358'),
	('Johnathan Huff','1562 Aviation Way','(430) 532-6406'),
	('Kaia Emerson','4412 Broadway Street','(566) 494-2138'),
	('Ahsan Sellers','4676 Lords Way','(312) 903-3033'),
	('Hallie Ridley','3654 Langtown Road','(806) 341-7207'),
	('Clement Martin','2757 Lynn Ogden Lane','(772) 788-6476'),
	('Monika Parker','3197 Medical Center Drive','(458) 477-8328'),
	('Ayse Hines','243 Tuna Street','(374) 800-5711'),
	('Zach Murray','123 Gotham City','(555)-558-8008')
	;
	
INSERT INTO BOOK_AUTHORS
	(BookID, AuthorName)
	VALUES
	(3001, 'Lee, Mark'),
	(3002, 'Brown, Dan'),
	(3003, 'Rowling, J. K.'),
	(3004, 'Meyer, Stephenie'),
	(3005, 'Sebold, Alice'),
	(3006, 'Haddon, Mark'),
	(3007, 'Larsson, Stieg'),
	(3008, 'Hosseini, Khaled'),
	(3009, 'Niffenegger, Audrey'),
	(3010, 'Clarkson, Jeremy'),
	(3011, 'McEwan, Ian'),
	(3012, 'Bryson, Bill'),
	(3013, 'Pelzer, Dave'),
	(3014, 'McCall Smith, Alexander'),
	(3015, 'McKeith, Gillian'),
	(3016, 'Parsons, Tony'),
	(3017, 'Faulks, Sebastian'),
	(3018, 'Mosse, Kate'),
	(3019, 'Hislop, Victoria'),
	(3020, 'King, Stephen'),
	(3021, 'King, Stephen')
	;

INSERT INTO BOOK_COPIES
	(BookID, BranchID, Number_Of_Copies)
	VALUES
	(3001,2001,6),
	(3002,2001,10),
	(3003,2001,6),
	(3004,2001,8),
	(3005,2001,5),
	(3006,2001,10),
	(3007,2001,10),
	(3008,2001,6),
	(3009,2001,9),
	(3010,2001,5),
	(3011,2001,6),
	(3012,2001,5),
	(3013,2001,5),
	(3014,2001,6),
	(3015,2001,8),
	(3016,2001,9),
	(3017,2001,5),
	(3018,2001,8),
	(3019,2001,6),
	(3020,2001,5),
	(3021,2001,6),
	(3001,2002,9),
	(3002,2002,10),
	(3003,2002,6),
	(3004,2002,6),
	(3005,2002,6),
	(3006,2002,8),
	(3007,2002,10),
	(3008,2002,6),
	(3009,2002,8),
	(3010,2002,9),
	(3011,2002,7),
	(3012,2002,6),
	(3013,2002,8),
	(3014,2002,10),
	(3015,2002,7),
	(3016,2002,6),
	(3017,2002,9),
	(3018,2002,10),
	(3019,2002,5),
	(3020,2002,7),
	(3021,2002,10),
	(3001,2003,5),
	(3002,2003,5),
	(3003,2003,9),
	(3004,2003,8),
	(3005,2003,9),
	(3006,2003,10),
	(3007,2003,9),
	(3008,2003,7),
	(3009,2003,8),
	(3010,2003,9),
	(3011,2003,5),
	(3012,2003,9),
	(3013,2003,6),
	(3014,2003,9),
	(3015,2003,5),
	(3016,2003,9),
	(3017,2003,9),
	(3018,2003,7),
	(3019,2003,7),
	(3020,2003,9),
	(3021,2003,8),
	(3001,2004,7),
	(3002,2004,8),
	(3003,2004,7),
	(3004,2004,10),
	(3005,2004,6),
	(3006,2004,9),
	(3007,2004,10),
	(3008,2004,8),
	(3009,2004,6),
	(3010,2004,10),
	(3011,2004,5),
	(3012,2004,10),
	(3013,2004,6),
	(3014,2004,6),
	(3015,2004,7),
	(3016,2004,10),
	(3017,2004,10),
	(3018,2004,10),
	(3019,2004,10),
	(3020,2004,7),
	(3021,2004,6),
	(3001,2005,10),
	(3002,2005,5),
	(3003,2005,6),
	(3004,2005,9),
	(3005,2005,6),
	(3006,2005,9),
	(3007,2005,6),
	(3008,2005,6),
	(3009,2005,7),
	(3010,2005,8),
	(3011,2005,7),
	(3012,2005,7),
	(3013,2005,6),
	(3014,2005,10),
	(3015,2005,8),
	(3016,2005,9),
	(3017,2005,8),
	(3018,2005,7),
	(3019,2005,10),
	(3020,2005,5),
	(3021,2005,6),
	(3001,2006,10),
	(3002,2006,7),
	(3003,2006,10),
	(3004,2006,10),
	(3005,2006,7),
	(3006,2006,6),
	(3007,2006,6),
	(3008,2006,5),
	(3009,2006,8),
	(3010,2006,7),
	(3011,2006,5),
	(3012,2006,9),
	(3013,2006,9),
	(3014,2006,7),
	(3015,2006,7),
	(3016,2006,5),
	(3017,2006,6),
	(3018,2006,8),
	(3019,2006,7),
	(3020,2006,6),
	(3021,2006,5)
	;

INSERT INTO BOOK_LOANS
	(BookID, BranchID, CardNo, DateOut, DateDue)
	VALUES
	(3003, 2001, 4003,  '2019-02-01', '2019-02-15'),
	(3004, 2003, 4006,  '2019-01-05', '2019-01-19'),
	(3005, 2001, 4013,  '2019-01-21', '2019-02-04'),
	(3009, 2003, 4004,  '2019-01-05', '2019-01-19'),
	(3008, 2006, 4006,  '2019-01-10', '2019-01-24'),
	(3015, 2001, 4003,  '2019-01-07', '2019-01-21'),
	(3016, 2002, 4004,  '2019-02-03', '2019-02-17'),
	(3017, 2006, 4001,  '2019-01-26', '2019-02-09'),
	(3016, 2001, 4012,  '2019-01-04', '2019-01-18'),
	(3016, 2003, 4009,  '2019-01-27', '2019-02-10'),
	(3006, 2004, 4007,  '2019-01-28', '2019-02-11'),
	(3009, 2004, 4006,  '2019-02-01', '2019-02-15'),
	(3005, 2004, 4010,  '2019-01-31', '2019-02-14'),
	(3019, 2006, 4014,  '2019-01-18', '2019-02-01'),
	(3011, 2005, 4008,  '2019-01-03', '2019-01-17'),
	(3013, 2001, 4003,  '2019-02-04', '2019-02-18'),
	(3008, 2003, 4013,  '2019-01-04', '2019-01-18'),
	(3005, 2002, 4007,  '2019-01-11', '2019-01-25'),
	(3012, 2002, 4009,  '2019-01-12', '2019-01-26'),
	(3016, 2005, 4011,  '2019-01-21', '2019-02-04'),
	(3013, 2003, 4001,  '2019-01-08', '2019-01-22'),
	(3011, 2002, 4003,  '2019-02-03', '2019-02-17'),
	(3001, 2003, 4005,  '2019-01-27', '2019-02-10'),
	(3003, 2002, 4006,  '2019-01-27', '2019-02-10'),
	(3003, 2004, 4006,  '2019-01-26', '2019-02-09'),
	(3001, 2002, 4003,  '2019-01-31', '2019-02-14'),
	(3014, 2002, 4014,  '2019-01-22', '2019-02-05'),
	(3006, 2002, 4008,  '2019-01-23', '2019-02-06'),
	(3012, 2001, 4005,  '2019-01-10', '2019-01-24'),
	(3007, 2004, 4013,  '2019-02-09', '2019-02-23'),
	(3012, 2003, 4007,  '2019-01-26', '2019-02-09'),
	(3017, 2002, 4005,  '2019-01-21', '2019-02-04'),
	(3019, 2004, 4005,  '2019-01-10', '2019-01-24'),
	(3005, 2001, 4006,  '2019-01-31', '2019-02-14'),
	(3016, 2001, 4002,  '2019-02-09', '2019-02-23'),
	(3010, 2004, 4012,  '2019-01-10', '2019-01-24'),
	(3016, 2003, 4005,  '2019-01-07', '2019-01-21'),
	(3005, 2005, 4004,  '2019-01-16', '2019-01-30'),
	(3018, 2006, 4011,  '2019-02-05', '2019-02-19'),
	(3013, 2004, 4004,  '2019-01-21', '2019-02-04'),
	(3019, 2001, 4009,  '2019-01-25', '2019-02-08'),
	(3018, 2002, 4002,  '2019-01-26', '2019-02-09'),
	(3009, 2001, 4005,  '2019-01-03', '2019-01-17'),
	(3002, 2002, 4009,  '2019-01-14', '2019-01-28'),
	(3019, 2002, 4010,  '2019-01-29', '2019-02-12'),
	(3004, 2006, 4006,  '2019-01-27', '2019-02-10'),
	(3004, 2002, 4004,  '2019-01-14', '2019-01-28'),
	(3012, 2006, 4011,  '2019-01-20', '2019-02-03'),
	(3006, 2002, 4008,  '2019-01-02', '2019-01-16'),
	(3005, 2004, 4005,  '2019-02-04', '2019-02-18'),
	(3014, 2001, 4007,  '2019-02-01', '2019-02-10'),
	(3008, 2004, 4009,  '2019-01-05', '2019-02-10'),
	(3007, 2001, 4007,  '2019-01-21', '2019-02-11'),
	(3004, 2001, 4012,  '2019-01-05', '2019-02-11'),
	(3013, 2006, 4003,  '2019-01-10', '2019-02-12'),
	(3002, 2002, 4005,  '2019-01-07', '2019-02-12'),
	(3003, 2004, 4013,  '2019-02-03', '2019-02-13'),
	(3003, 2001, 4004,  '2019-01-26', '2019-02-13'),
	(3011, 2001, 4007,  '2019-01-04', '2019-02-14'),
	(3012, 2002, 4014,  '2019-01-27', '2019-02-14'),
	(3006, 2003, 4010,  '2019-01-28', '2019-02-15'),
	(3005, 2006, 4011,  '2019-02-01', '2019-02-15'),
	(3017, 2002, 4001,  '2019-01-31', '2019-02-16'),
	(3009, 2003, 4002,  '2019-01-18', '2019-02-16'),
	(3015, 2001, 4011,  '2019-01-03', '2019-02-17'),
	(3011, 2004, 4004,  '2019-02-04', '2019-02-17'),
	(3004, 2005, 4003,  '2019-01-04', '2019-02-18'),
	(3011, 2003, 4008,  '2019-01-11', '2019-02-18'),
	(3004, 2006, 4002,  '2019-01-12', '2019-02-19'),
	(3006, 2003, 4009,  '2019-01-21', '2019-02-19'),
	(3019, 2004, 4008,  '2019-01-08', '2019-02-20'),
	(3002, 2002, 4013,  '2019-02-03', '2019-02-20'),
	(3003, 2005, 4010,  '2019-01-27', '2019-02-21'),
	(3020, 2006, 4005,  '2019-01-27', '2019-02-21'),
	(3005, 2004, 4001,  '2019-01-26', '2019-02-22'),
	(3004, 2006, 4008,  '2019-01-31', '2019-02-22'),
	(3006, 2005, 4011,  '2019-01-22', '2019-02-23'),
	(3014, 2001, 4011,  '2019-01-23', '2019-02-23'),
	(3001, 2004, 4004,  '2019-01-10', '2019-02-24'),
	(3013, 2001, 4004,  '2019-02-09', '2019-02-24'),
	(3011, 2006, 4013,  '2019-01-12', '2019-02-25'),
	(3005, 2004, 4003,  '2019-01-21', '2019-02-25'),
	(3011, 2001, 4008,  '2019-01-08', '2019-02-26'),
	(3015, 2002, 4013,  '2019-02-03', '2019-02-26'),
	(3019, 2006, 4010,  '2019-01-27', '2019-02-27'),
	(3006, 2004, 4007,  '2019-01-27', '2019-02-27'),
	(3013, 2005, 4001,  '2019-01-26', '2019-02-28'),
	(3010, 2006, 4010,  '2019-01-31', '2019-02-28'),
	(3002, 2006, 4010,  '2019-01-22', '2019-03-01'),
	(3019, 2001, 4004,  '2019-01-23', '2019-03-01'),
	(3019, 2004, 4002,  '2019-01-10', '2019-03-02'),
	(3021, 2001, 4003,  '2019-02-09', '2019-03-02'),
	(3001, 2004, 4012,  '2019-02-01', '2019-02-10'),
	(3004, 2004, 4012,  '2019-01-05', '2019-02-10'),
	(3020, 2006, 4008,  '2019-01-21', '2019-02-11'),
	(3003, 2002, 4004,  '2019-01-05', '2019-02-11'),
	(3012, 2001, 4003,  '2019-01-10', '2019-02-12'),
	(3001, 2004, 4006,  '2019-01-07', '2019-02-12'),
	(3001, 2003, 4003,  '2019-02-03', '2019-02-13'),
	(3007, 2003, 4013,  '2019-01-26', '2019-02-13'),
	(3015, 2005, 4003,  '2019-01-04', '2019-02-14'),
	(3008, 2006, 4010,  '2019-01-27', '2019-02-14'),
	(3012, 2004, 4011,  '2019-01-28', '2019-02-15'),
	(3002, 2005, 4002,  '2019-02-01', '2019-02-15'),
	(3018, 2002, 4006,  '2019-01-31', '2019-02-16'),
	(3013, 2004, 4005,  '2019-01-18', '2019-02-16'),
	(3002, 2006, 4006,  '2019-01-03', '2019-02-17'),
	(3015, 2002, 4002,  '2019-02-04', '2019-02-17'),
	(3006, 2006, 4006,  '2019-01-04', '2019-02-18'),
	(3019, 2001, 4001,  '2019-01-11', '2019-02-18'),
	(3012, 2002, 4005,  '2019-01-12', '2019-02-19'),
	(3014, 2006, 4005,  '2019-01-21', '2019-02-19'),
	(3014, 2001, 4004,  '2019-01-08', '2019-02-20'),
	(3008, 2002, 4006,  '2019-02-03', '2019-02-20'),
	(3019, 2006, 4012,  '2019-01-27', '2019-02-21'),
	(3019, 2004, 4004,  '2019-01-27', '2019-02-21'),
	(3007, 2003, 4013,  '2019-01-26', '2019-02-22'),
	(3009, 2002, 4013,  '2019-01-31', '2019-02-22'),
	(3009, 2004, 4003,  '2019-01-22', '2019-02-23'),
	(3005, 2004, 4014,  '2019-01-23', '2019-02-23'),
	(3001, 2002, 4003,  '2019-01-10', '2019-02-24'),
	(3020, 2004, 4013,  '2019-02-09', '2019-02-24'),
	(3006, 2003, 4001,  '2019-01-12', '2019-02-25'),
	(3021, 2004, 4005,  '2019-01-21', '2019-02-25'),
	(3010, 2001, 4013,  '2019-01-08', '2019-02-26'),
	(3014, 2002, 4013,  '2019-02-03', '2019-02-26'),
	(3011, 2003, 4003,  '2019-01-27', '2019-02-27'),
	(3003, 2004, 4006,  '2019-01-27', '2019-02-27'),
	(3021, 2003, 4003,  '2019-01-26', '2019-02-28'),
	(3003, 2003, 4006,  '2019-01-31', '2019-02-28'),
	(3004, 2004, 4002,  '2019-01-22', '2019-03-01'),
	(3021, 2004, 4010,  '2019-01-23', '2019-03-01'),
	(3009, 2001, 4011,  '2019-01-10', '2019-03-02'),
	(3017, 2005, 4001,  '2019-02-09', '2019-03-02'),
	(3012, 2006, 4004,  '2019-02-01', '2019-02-10'),
	(3016, 2004, 4006,  '2019-01-05', '2019-02-10'),
	(3009, 2006, 4002,  '2019-01-21', '2019-02-11'),
	(3001, 2001, 4014,  '2019-01-05', '2019-02-11'),
	(3021, 2005, 4007,  '2019-01-10', '2019-02-12'),
	(3007, 2003, 4002,  '2019-01-07', '2019-02-12'),
	(3014, 2001, 4004,  '2019-02-03', '2019-02-13'),
	(3004, 2002, 4002,  '2019-01-26', '2019-02-13'),
	(3013, 2006, 4013,  '2019-01-04', '2019-02-14'),
	(3011, 2001, 4014,  '2019-01-27', '2019-02-14'),
	(3014, 2002, 4002,  '2019-01-28', '2019-02-15'),
	(3015, 2005, 4014,  '2019-02-01', '2019-02-15'),
	(3003, 2001, 4001,  '2019-01-31', '2019-02-16'),
	(3007, 2003, 4001,  '2019-01-18', '2019-02-16'),
	(3021, 2001, 4002,  '2019-01-03', '2019-02-17'),
	(3011, 2006, 4006,  '2019-02-04', '2019-02-17'),
	(3005, 2006, 4014,  '2019-01-04', '2019-02-18'),
	(3015, 2005, 4005,  '2019-01-11', '2019-02-18'),
	(3013, 2002, 4004,  '2019-01-12', '2019-02-19'),
	(3006, 2003, 4010,  '2019-01-21', '2019-02-19'),
	(3013, 2003, 4013,  '2019-01-08', '2019-02-20'),
	(3014, 2004, 4002,  '2019-02-03', '2019-02-20'),
	(3018, 2005, 4014,  '2019-01-27', '2019-02-21'),
	(3001, 2006, 4003,  '2019-01-27', '2019-02-21'),
	(3013, 2005, 4007,  '2019-01-26', '2019-02-22'),
	(3004, 2003, 4007,  '2019-01-31', '2019-02-22'),
	(3001, 2001, 4012,  '2019-01-22', '2019-02-23'),
	(3015, 2001, 4002,  '2019-01-23', '2019-02-23'),
	(3004, 2003, 4009,  '2019-01-10', '2019-02-24'),
	(3016, 2001, 4004,  '2019-02-09', '2019-02-24'),
	(3014, 2004, 4004,  '2019-01-12', '2019-02-25'),
	(3010, 2005, 4012,  '2019-01-21', '2019-02-25'),
	(3016, 2003, 4008,  '2019-01-08', '2019-02-26'),
	(3016, 2003, 4005,  '2019-02-03', '2019-02-26'),
	(3006, 2002, 4008,  '2019-01-27', '2019-02-27'),
	(3012, 2004, 4005,  '2019-01-27', '2019-02-27'),
	(3012, 2003, 4011,  '2019-01-26', '2019-02-28'),
	(3016, 2006, 4001,  '2019-01-31', '2019-02-28'),
	(3020, 2006, 4013,  '2019-01-22', '2019-03-01'),
	(3021, 2004, 4007,  '2019-01-23', '2019-03-01'),
	(3015, 2006, 4006,  '2019-01-10', '2019-03-02'),
	(3006, 2005, 4011,  '2019-02-09', '2019-03-02'),
	(3020, 2003, 4008,  '2019-01-02', '2019-01-20'),
	(3020, 2005, 4008,  '2019-01-03', '2019-01-20'),
	(3015, 2005, 4005,  '2019-01-03', '2019-01-21'),
	(3015, 2005, 4012,  '2019-01-04', '2019-01-21'),
	(3018, 2005, 4013,  '2019-01-04', '2019-01-22'),
	(3005, 2004, 4006,  '2019-01-05', '2019-01-22'),
	(3017, 2002, 4004,  '2019-01-05', '2019-01-23'),
	(3016, 2005, 4003,  '2019-01-07', '2019-01-23'),
	(3015, 2004, 4005,  '2019-01-07', '2019-01-24'),
	(3010, 2001, 4001,  '2019-01-08', '2019-01-24'),
	(3018, 2005, 4006,  '2019-01-10', '2019-01-25'),
	(3012, 2004, 4005,  '2019-01-10', '2019-01-25'),
	(3012, 2004, 4005,  '2019-01-10', '2019-01-26'),
	(3011, 2002, 4012,  '2019-01-10', '2019-01-26'),
	(3018, 2002, 4007,  '2019-01-11', '2019-01-27'),
	(3019, 2002, 4009,  '2019-01-12', '2019-01-27'),
	(3001, 2003, 4009,  '2019-01-14', '2019-01-28'),
	(3017, 2006, 4004,  '2019-01-14', '2019-01-28'),
	(3015, 2003, 4004,  '2019-01-16', '2019-01-29'),
	(3004, 2001, 4014,  '2019-01-18', '2019-01-29'),
	(3006, 2003, 4011,  '2019-01-20', '2019-01-30'),
	(3020, 2006, 4013,  '2019-01-21', '2019-01-30'),
	(3001, 2003, 4011,  '2019-01-21', '2019-01-31'),
	(3002, 2006, 4005,  '2019-01-21', '2019-01-31'),
	(3009, 2003, 4004,  '2019-01-21', '2019-02-01'),
	(3017, 2006, 4014,  '2019-01-22', '2019-02-01'),
	(3004, 2001, 4008,  '2019-01-23', '2019-02-02'),
	(3012, 2002, 4009,  '2019-01-25', '2019-02-02'),
	(3019, 2002, 4001,  '2019-01-26', '2019-02-03'),
	(3003, 2002, 4006,  '2019-01-26', '2019-02-03'),
	(3007, 2002, 4007,  '2019-01-26', '2019-02-04'),
	(3007, 2005, 4002,  '2019-01-26', '2019-02-04'),
	(3003, 2005, 4009,  '2019-01-27', '2019-02-05'),
	(3003, 2006, 4005,  '2019-01-27', '2019-02-05'),
	(3010, 2004, 4006,  '2019-01-27', '2019-02-06'),
	(3020, 2003, 4006,  '2019-01-27', '2019-02-06'),
	(3015, 2001, 4008,  '2019-02-01', '2019-02-07'),
	(3019, 2001, 4003,  '2019-01-05', '2019-02-07'),
	(3008, 2006, 4007,  '2019-02-01', '2019-02-08'),
	(3002, 2001, 4013,  '2019-01-05', '2019-02-08'),
	(3020, 2005, 4010,  '2019-02-01', '2019-02-09'),
	(3004, 2006, 4012,  '2019-01-05', '2019-02-09'),
	(3002, 2002, 4007,  '2019-01-28', '2019-02-10'),
	(3011, 2001, 4006,  '2019-01-21', '2019-02-10'),
	(3010, 2003, 4011,  '2019-01-05', '2019-02-11'),
	(3002, 2006, 4012,  '2019-01-21', '2019-02-11'),
	(3002, 2004, 4004,  '2019-01-05', '2019-02-12'),
	(3018, 2004, 4012,  '2019-01-21', '2019-02-12'),
	(3019, 2002, 4011,  '2019-01-05', '2019-02-13'),
	(3003, 2002, 4010,  '2019-01-29', '2019-02-13'),
	(3010, 2003, 4003,  '2019-01-10', '2019-02-14'),
	(3015, 2002, 4002,  '2019-01-07', '2019-02-14'),
	(3003, 2002, 4011,  '2019-01-10', '2019-02-15'),
	(3007, 2004, 4001,  '2019-01-07', '2019-02-15'),
	(3019, 2001, 4007,  '2019-01-10', '2019-02-16'),
	(3017, 2003, 4011,  '2019-01-07', '2019-02-16'),
	(3004, 2003, 4011,  '2019-02-03', '2019-02-17'),
	(3014, 2004, 4003,  '2019-01-26', '2019-02-17'),
	(3012, 2001, 4014,  '2019-02-03', '2019-02-18'),
	(3008, 2006, 4008,  '2019-01-26', '2019-02-18'),
	(3012, 2002, 4003,  '2019-02-03', '2019-02-19'),
	(3004, 2001, 4002,  '2019-01-26', '2019-02-19'),
	(3005, 2004, 4010,  '2019-01-31', '2019-02-20'),
	(3001, 2002, 4003,  '2019-01-31', '2019-02-20'),
	(3005, 2001, 4006,  '2019-01-31', '2019-02-21'),
	(3001, 2003, 4012,  '2019-01-04', '2019-02-21'),
	(3008, 2005, 4001,  '2019-01-27', '2019-02-22'),
	(3018, 2003, 4005,  '2019-01-04', '2019-02-22'),
	(3008, 2002, 4004,  '2019-01-27', '2019-02-23'),
	(3015, 2003, 4003,  '2019-01-04', '2019-02-23'),
	(3019, 2003, 4003,  '2019-01-27', '2019-02-24'),
	(3003, 2001, 4003,  '2019-02-01', '2019-02-24'),
	(3009, 2004, 4006,  '2019-02-01', '2019-02-25'),
	(3002, 2006, 4014,  '2019-01-28', '2019-02-25'),
	(3002, 2003, 4014,  '2019-02-01', '2019-02-26'),
	(3017, 2006, 4010,  '2019-01-28', '2019-02-26'),
	(3005, 2001, 4007,  '2019-02-01', '2019-02-27'),
	(3021, 2004, 4010,  '2019-01-28', '2019-02-27'),
	(3011, 2005, 4001,  '2019-02-01', '2019-02-28'),
	(3014, 2006, 4006,  '2019-01-31', '2019-02-28'),
	(3004, 2003, 4014,  '2019-01-18', '2019-03-01'),
	(3005, 2002, 4001,  '2019-01-31', '2019-03-01'),
	(3003, 2001, 4004,  '2019-01-18', '2019-03-02'),
	(3005, 2003, 4007,  '2019-01-31', '2019-03-02'),
	(3015, 2001, 4014,  '2019-01-18', '2019-03-03'),
	(3016, 2002, 4004,  '2019-02-03', '2019-03-03'),
	(3011, 2002, 4003,  '2019-02-03', '2019-03-04'),
	(3015, 2003, 4007,  '2019-01-03', '2019-03-04'),
	(3005, 2004, 4007,  '2019-02-04', '2019-03-05'),
	(3015, 2003, 4007,  '2019-01-03', '2019-03-05'),
	(3019, 2002, 4012,  '2019-02-04', '2019-03-06'),
	(3021, 2005, 4008,  '2019-01-03', '2019-03-06'),
	(3012, 2005, 4012,  '2019-02-04', '2019-03-07'),
	(3013, 2001, 4003,  '2019-02-04', '2019-03-07'),
	(3005, 2004, 4005,  '2019-02-04', '2019-03-08'),
	(3002, 2004, 4001,  '2019-01-04', '2019-03-08'),
	(3005, 2001, 4003,  '2019-01-11', '2019-03-09'),
	(3009, 2004, 4014,  '2019-01-04', '2019-03-09'),
	(3007, 2005, 4013,  '2019-01-11', '2019-03-10'),
	(3013, 2003, 4007,  '2019-01-04', '2019-03-10'),
	(3009, 2002, 4004,  '2019-01-11', '2019-03-11'),
	(3018, 2006, 4011,  '2019-02-05', '2019-03-11'),
	(3007, 2003, 4002,  '2019-01-12', '2019-03-12'),
	(3002, 2003, 4013,  '2019-01-21', '2019-03-12'),
	(3005, 2006, 4007,  '2019-01-12', '2019-03-13'),
	(3014, 2005, 4009,  '2019-01-21', '2019-03-13'),
	(3020, 2006, 4012,  '2019-01-12', '2019-03-14'),
	(3011, 2004, 4010,  '2019-01-21', '2019-03-14'),
	(3011, 2001, 4002,  '2019-01-08', '2019-03-15'),
	(3015, 2005, 4012,  '2019-02-03', '2019-03-15'),
	(3014, 2004, 4003,  '2019-01-08', '2019-03-16'),
	(3019, 2001, 4010,  '2019-02-03', '2019-03-16'),
	(3008, 2006, 4005,  '2019-01-08', '2019-03-17'),
	(3007, 2003, 4008,  '2019-02-03', '2019-03-17'),
	(3002, 2004, 4014,  '2019-01-27', '2019-03-18'),
	(3006, 2004, 4001,  '2019-01-27', '2019-03-18'),
	(3014, 2001, 4014,  '2019-01-27', '2019-03-19'),
	(3005, 2004, 4005,  '2019-01-27', '2019-03-19'),
	(3019, 2004, 4009,  '2019-01-27', '2019-03-20'),
	(3016, 2004, 4014,  '2019-01-27', '2019-03-20'),
	(3015, 2002, 4006,  '2019-01-26', '2019-03-21'),
	(3015, 2006, 4001,  '2019-01-31', '2019-03-21'),
	(3007, 2006, 4006,  '2019-01-26', '2019-03-22'),
	(3015, 2002, 4014,  '2019-01-31', '2019-03-22'),
	(3004, 2004, 4012,  '2019-01-26', '2019-03-23'),
	(3007, 2003, 4002,  '2019-01-31', '2019-03-23'),
	(3007, 2004, 4013,  '2019-02-09', '2019-03-24'),
	(3016, 2001, 4002,  '2019-02-09', '2019-03-24'),
	(3016, 2006, 4008,  '2019-01-22', '2019-03-25'),
	(3003, 2003, 4009,  '2019-01-23', '2019-03-25'),
	(3012, 2002, 4012,  '2019-01-22', '2019-03-26'),
	(3014, 2001, 4004,  '2019-01-23', '2019-03-26'),
	(3003, 2004, 4013,  '2019-01-22', '2019-03-27'),
	(3004, 2002, 4002,  '2019-01-23', '2019-03-27'),
	(3021, 2003, 4001,  '2019-01-10', '2019-03-28'),
	(3020, 2004, 4012,  '2019-02-09', '2019-03-28'),
	(3013, 2005, 4007,  '2019-01-10', '2019-03-29'),
	(3019, 2003, 4002,  '2019-02-09', '2019-03-29'),
	(3009, 2003, 4003,  '2019-01-10', '2019-03-30'),
	(3003, 2001, 4011,  '2019-02-09', '2019-03-30'),
	(3001, 2006, 4014,  '2019-01-12', '2019-03-31'),
	(3003, 2001, 4010,  '2019-01-21', '2019-03-31'),
	(3011, 2004, 4007,  '2019-01-12', '2019-04-01'),
	(3008, 2002, 4014,  '2019-01-21', '2019-04-01'),
	(3004, 2003, 4006,  '2019-01-12', '2019-04-02'),
	(3009, 2002, 4008,  '2019-01-21', '2019-04-02'),
	(3017, 2003, 4008,  '2019-01-08', '2019-04-03'),
	(3007, 2005, 4009,  '2019-02-03', '2019-04-03'),
	(3009, 2006, 4003,  '2019-01-08', '2019-04-04'),
	(3008, 2002, 4014,  '2019-02-03', '2019-04-04'),
	(3015, 2003, 4012,  '2019-01-08', '2019-04-05'),
	(3003, 2005, 4011,  '2019-02-03', '2019-04-05'),
	(3005, 2006, 4010,  '2019-01-27', '2019-04-06'),
	(3015, 2003, 4013,  '2019-01-27', '2019-04-06'),
	(3003, 2003, 4011,  '2019-01-27', '2019-04-07'),
	(3016, 2004, 4009,  '2019-01-27', '2019-04-07'),
	(3018, 2006, 4005,  '2019-01-27', '2019-04-08'),
	(3016, 2006, 4009,  '2019-01-27', '2019-04-08'),
	(3004, 2006, 4009,  '2019-01-26', '2019-04-09'),
	(3018, 2002, 4010,  '2019-01-31', '2019-04-09'),
	(3021, 2001, 4012,  '2019-01-26', '2019-04-10'),
	(3021, 2003, 4002,  '2019-01-31', '2019-04-10'),
	(3019, 2005, 4011,  '2019-01-26', '2019-04-11'),
	(3011, 2005, 4014,  '2019-01-31', '2019-04-11'),
	(3006, 2005, 4006,  '2019-01-22', '2019-04-12'),
	(3020, 2001, 4009,  '2019-01-23', '2019-04-12'),
	(3010, 2002, 4007,  '2019-01-22', '2019-04-13'),
	(3014, 2002, 4010,  '2019-01-23', '2019-04-13'),
	(3014, 2002, 4004,  '2019-01-22', '2019-04-14'),
	(3011, 2004, 4008,  '2019-01-23', '2019-04-14'),
	(3015, 2003, 4002,  '2019-01-10', '2019-04-15'),
	(3017, 2005, 4004,  '2019-02-09', '2019-04-15'),
	(3012, 2006, 4013,  '2019-01-10', '2019-04-16'),
	(3006, 2002, 4003,  '2019-02-09', '2019-04-16'),
	(3011, 2006, 4014,  '2019-01-10', '2019-04-17'),
	(3020, 2002, 4005,  '2019-02-09', '2019-04-17')
	;	

/*
CREATE STORED PROCEDURES THAT WILL QUERY FOR EACH OF THE FOLLOWING QUESTIONS:
====================================================================================================================================================================
1.) How many copies of the book titled "The Lost Tribe" are owned by the library branch whose name is "Sharpstown"?
======================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_1
AS

SELECT Title, BranchName, Number_Of_Copies FROM BOOK_COPIES
	INNER JOIN	BOOKS ON BOOK_COPIES.BookID = BOOKS.BookID
	INNER JOIN LIBRARY_BRANCH on BOOK_COPIES.BranchID = LIBRARY_BRANCH.BranchID
	WHERE BranchName LIKE 'Sharpstown' AND Title = 'The Lost Tribe'

GO

EXEC Question_1


/*====================================================================================================================================================================
2.) How many copies of the book titled "The Lost Tribe" are owned by each library branch?
======================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_2
AS

SELECT Title, BranchName, Number_Of_Copies FROM BOOK_COPIES
	INNER JOIN	BOOKS ON BOOK_COPIES.BookID = BOOKS.BookID
	INNER JOIN LIBRARY_BRANCH on BOOK_COPIES.BranchID = LIBRARY_BRANCH.BranchID
	WHERE Title = 'The Lost Tribe'

GO

EXEC Question_2

/*====================================================================================================================================================================
3.) Retrieve the names of all borrowers who do not have any books checked out.
======================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_3
AS

SELECT Name FROM BORROWER 
	WHERE NOT EXISTS 
		(SELECT * FROM BOOK_LOANS
			 WHERE BORROWER.CardNo = BOOK_LOANS.CardNo)

GO

EXEC Question_3


/*====================================================================================================================================================================
4.) For each book that is loaned out from the "Sharpstown" branch and whose DueDate is today, retrieve the book title, the borrower's name, and the borrower's address.


NOTE
Query will return based on current system date
however
LAST DueDate in table is 2019-04-17 


======================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_4
AS

SELECT Title, Name, Address, DateDue FROM BOOK_LOANS
	INNER JOIN BORROWER ON BOOK_LOANS.CardNo = BORROWER.CardNo
	INNER JOIN BOOKS ON BOOK_LOANS.BookID = BOOKS.BookID
	WHERE DateDue = CONVERT(date, getdate())

GO

EXEC Question_4

/*====================================================================================================================================================================
5.) For each library branch, retrieve the branch name and the total number of books loaned out from that branch.
=====================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_5
AS
SELECT COUNT(BookID) As '# Books on Loan', BranchName FROM BOOK_LOANS
	INNER JOIN LIBRARY_BRANCH ON BOOK_LOANS.BranchID = LIBRARY_BRANCH.BranchID
GROUP BY BranchName

GO

EXEC Question_5

/*====================================================================================================================================================================
6.) Retrieve the names, addresses, and the number of books checked out for all borrowers who have more than five books checked out.

As I added many rows of data in the Book_Loan table to facilitate Excercise #4 for future due Dates,
the query pulls all borrows excpet Zach Murray (my name, which was inserted to fulfill the no books ordered in #3.



=====================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_6
AS
SELECT COUNT(Name) As '# Books on Loan', Name FROM BOOK_LOANS
	INNER JOIN BORROWER ON BOOK_LOANS.CardNo = BORROWER.CardNo
	GROUP BY Name 
	HAVING COUNT(Name) > 5
GO

EXEC Question_6

/*====================================================================================================================================================================
7.) For each book authored (or co-authored) by "Stephen King", retrieve the title and the number of copies owned by the library branch whose name is "Central".
=====================================================================================================================================================================*/

GO
CREATE PROCEDURE Question_7
AS
SELECT TITLE, AuthorName, BranchName From BOOK_COPIES
	INNER JOIN BOOKS ON BOOK_COPIES.BookID = BOOKS.BookID
	INNER JOIN BOOK_AUTHORS ON BOOKS.BookID = BOOK_AUTHORS.BookID
	inner join LIBRARY_BRANCH on BOOK_COPIES.BranchID = LIBRARY_BRANCH.BranchID
	WHERE AuthorName = 'King, Stephen' AND BranchName = 'Central'
GO

EXEC Question_7





